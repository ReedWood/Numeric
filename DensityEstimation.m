x=[4.37,4.7,1.68,1.75,4.35,1.77,4.25,4.1,4.05,1.90,4,4.42,1.83,1.83,3.95,4.83,3.87,1.73,3.92,3.20,2.33,4.57,3.58,3.70,4.25,3.58,3.67,1.9,4.13,4.53,4.10,4.12,4,4.93,3.68,1.85,3.83,1.85,3.8,3.8,3.33,3.73,1.67,4.63,1.83,2.03,2.72,4.03,1.73,3.1,4.62,1.88,3.52,3.77,3.43,2,3.73,4.6,2.93,4.65,4.18,4.58,3.5,4.62,4.03,1.97,4.6,4,3.75,4,4.33,1.82,1.67,3.5,4.2,4.43,1.9,4.08,3.43,1.77,4.5,1.8,3.7,2.5,2.27,2.93,4.63,4,1.97,3.93,4.07,4.5,2.25,4.25,4.08,3.92,4.73,3.72,4.5,4.40,4.58,3.5,1.8,4.28,4.33,4.13,1.95];

%%Naive estimate
for i=1:length(xcont)
    f(i)=1/(2*length(x)*h)*length(find(x>(xcont(i)-h) & x<(xcont(i)+h)));
end

%Normal Kernel estimate
f = ksdensity(x,xcont,'width',h);

% nearestneigbrot
k=20;
for i=1:length(x);d(:,i)=abs(xcont-x(i));end
sorted=sort(d,2);
dk=sorted(:,k);
rhoNN=k./(2*length(x)*dk);